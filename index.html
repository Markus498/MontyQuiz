<!DOCTYPE html>

<html lang="en">

	<head>
		<meta charset = "UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
		<script src="cordova-2.1.0.js"></script>
		
		<title>Monty Python Quiz</title>
		
		
		<script type = "text/javascript">
			document.addEventListener("deviceready", onDeviceReady, false);
			
			var answers = new Array("Patsy", "False", "Shrubbery", "Moose", "Tim", "Swallow", "Dennis", "Holy Hand Grenade of Antioch", "Rabbit", "Duck");
					
			var user = prompt("What is your first name?" , "");		
			var sanitizedUser = user.replace(/[^\w\d]/g, "");
			if(!sanitizedUser) sanitizedUser = 'Herp';
			alert("Hi, " + sanitizedUser + " and welcome to my Monty Quiz app!");
						
			
			function getAnswers(){				
				var submittedAnswers = new Array();
				submittedAnswers = $('input:checked');
				return submittedAnswers; 
			}
			
			
			function updateHistory(data){
				var user = data[0];
				var score = data[1];
				var sql = 'INSERT INTO HISTORY(fname,score) VALUES("'+user+'", "'+score+'")';
				
				MontyDB.transaction(
					function (transaction) {
						transaction.executeSql(sql);});
			}
			
				
			function calculateScore(){
				var submittedAnswers = getAnswers();				
				var correct =0;						
				
				for (var k=0; k<submittedAnswers.length; k++){
					if (answers[k]==submittedAnswers[k].value){ ++correct;}				
				}
				
				var score = (correct / 10) * 100;
				var data = new Array(sanitizedUser, score);
				updateHistory(data);
			
				
				if (score >= 20 && score <= 30){ alert("Your score was: " + score + "%" + "\n" +  " Your mother was a hamster, and your father smelled of elderberries!");}
				
				if ( score >= 40 && score <= 50){ alert("Your score was: " + score + "%" + "\n"+ "NI! NI! NI! NI! NI!");}
				
				if (score >= 60 && score <= 70){ alert("Your score was: " + score + "%" + "\n" + "Brave brave Sir Robin, he bravely ran away!");}
				
				if (score >= 80 && score <= 90){ alert("Your score was: " + score + "%" + "\n" + "You and your knights have arrived at Camelot. It is a silly place.");}
				
				if (score >= 90 && score <= 95){ alert("Your score was: " + score + "%" + "\n" + "There are some who call me....Tim.");}
				
				if (score == 100){ alert("Behold! The Holy Grail. You step forth to claim it for the Almighty, but what is this? THE BLOODY FRENCH OF CASTLE AUGH STAND IN YOUR WAY! Fear not, for the brave Knights of the Round Table shall smite these foes!...Not really. You are arrested by policemen for violating history. THE END");}
				
				if (score >= 0 && score < 20){ alert("You didn't even try..for this grave injustice, you will forever be cursed to have rabbits follow you around everywhere, awaiting their chance to utterly destroy you with their...with their...RABBITY POWERS.");}
			}
			
			
			function createTables(MontyDB){
				MontyDB.executeSql('CREATE TABLE IF NOT EXISTS history(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, fname TEXT NOT NULL, score INTEGER NOT NULL)', []);
					
				
			}

	
			function initDatabase(){
				openDatabase('MontyDB', '1.0', 'Monty Quiz Database', 5*1024*1024, function (db) {
					db.changeVersion('', '1.0', function (t) {
					t.executeSql('CREATE TABLE IF NOT EXISTS history(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, fname TEXT NOT NULL, score INTEGER NOT NULL);');
					}, error);
				});
				alert('Database created!');
					
			}	
			
			
			function onDeviceReady(){
				var db = window.openDatabase('MontyDB', '1.0', 'Monty Quiz Database', 5*1024*1024);
				
				db.transaction(createTables);
			}
		
			
		
		
		
		</script>
		
	</head>
	
	<body>
		<div data-role="page">
		
		
			<div data-role = "header">
				<h1>Quiz</h1>
			</div>
			<div data-role = "content" data-theme="b">
			
			<form id="montyQuiz">			
				<div data-role="fieldcontain">
				<fieldset data-role="controlgroup" data-type="vertical">
					<legend>Question 1: What is the name of Arthur's manservant?</legend>
						<input type="radio" name="question1" id="question1-radio-a" value="Patrick"/>
						<label for="question1-radio-a">A. Patrick</label>
						<input type="radio" name="question1" id="question1-radio-b" value="Pansy"/>
						<label for="question1-radio-b">B. Pansy</label>
						<input type="radio" name="question1" id="question1-radio-c" value="Patsy"/>
						<label for="question1-radio-c">C. Patsy</label>
						<input type="radio" name="question1" id="question1-radio-d" value="Richard"/>
						<label for="question1-radio-d">D. Richard</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role="controlgroup" data-type="vertical">
					<legend>Question 2: Do coconuts migrate?</legend>
						<input type="radio" name="question2" id="question2-radio-a" value="True"/>
						<label for="question2-radio-a">A. True</label>
						<input type="radio" name="question2" id="question2-radio-b" value="False"/>
						<label for="question2-radio-b">B. False</label>						
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 3: The knights of Ni demand what as a sacrifice?</legend>
						<input type="radio" name="question3" id="question3-radio-a" value="Human"/>
						<label for="question3-radio-a">A. Human</label>
						<input type="radio" name="question3" id="question3-radio-b" value="Horse"/>
						<label for="question3-radio-b">B. Horse </label>
						<input type="radio" name="question3" id="question3-radio-c" value="Flower"/>
						<label for="question3-radio-c">C. Flower </label>
						<input type="radio" name="question3" id="question3-radio-d" value="Shrubbery"/>
						<label for="question3-radio-d">D. Shrubbery </label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 4: What animal is repeatedly mentioned throughout the opening credits?</legend>
						<input type="radio" name="question4" id="question4-radio-a" value="Dog"/>
						<label for="question4-radio-a">A. Dog</label>
						<input type="radio" name="question4" id="question4-radio-b" value="Hamster"/>
						<label for="question4-radio-b">B. Hamster</label>
						<input type="radio" name="question4" id="question4-radio-c" value="Elk"/>
						<label for="question4-radio-c">C. Elk</label>
						<input type="radio" name="question4" id="question4-radio-d" value="Moose"/>
						<label for="question4-radio-d">D. Moose</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 5: What is the name of the Enchanter with goat horns?</legend>
						<input type="radio" name="question5" id="question5-radio-a" value="Tom"/>
						<label for="question5-radio-a">A. Tom</label>
						<input type="radio" name="question5" id="question5-radio-b" value="Jim"/>
						<label for="question5-radio-b">B. Jim</label>
						<input type="radio" name="question5" id="question5-radio-c" value="Tim"/>
						<label for="question5-radio-c">C. Tim</label>
						<input type="radio" name="question5" id="question5-radio-d" value="Frank"/>
						<label for="question5-radio-d">D. Frank</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 6: What bird comes up repeatedly in the movie?</legend>
						<input type="radio" name="question6" id="question6-radio-a" value="Pidgeon"/>
						<label for="question6-radio-a">A. Pidgeon</label>
						<input type="radio" name="question6" id="question6-radio-b" value="Swallow"/>
						<label for="question6-radio-b">B. Swallow</label>
						<input type="radio" name="question6" id="question6-radio-c" value="Parakeet"/>
						<label for="question6-radio-c">C. Parakeet</label>
						<input type="radio" name="question6" id="question6-radio-d" value="Finch"/>
						<label for="question6-radio-d">D. Finch</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 7: What is the name of the old woman Arthur encounters?</legend>
						<input type="radio" name="question7" id="question7-radio-a" value="Dennis"/>
						<label for="question7-radio-a">A. Dennis</label>
						<input type="radio" name="question7" id="question7-radio-b" value="Bob"/>
						<label for="question7-radio-b">B. Bob</label>
						<input type="radio" name="question7" id="question7-radio-c" value="Gretchen"/>
						<label for="question7-radio-c">C. Gretchen</label>
						<input type="radio" name="question7" id="question7-radio-d" value="Phanny"/>
						<label for="question7-radio-d">D. Phanny</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 8: What item is used to defeat the beast guarding the cave Caerbannag?</legend>
						<input type="radio" name="question8" id="question8-radio-a" value="Excalibur"/>
						<label for="question8-radio-a">A. Excalibur</label>
						<input type="radio" name="question8" id="question8-radio-b" value="Boot of the Almighty"/>
						<label for="question8-radio-b">B. Boot of the Almighty</label>
						<input type="radio" name="question8" id="question8-radio-c" value="Holy Hand Grenade of Antioch"/>
						<label for="question8-radio-c">C. Holy Hand Grenade of Antioch</label>
						<input type="radio" name="question8" id="question8-radio-d" value="A wooden spoon"/>
						<label for="question8-radio-d">D. A wooden spoon</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Question 9: What Trojan contraption was built by the knights to breach the French fortress?</legend>
						<input type="radio" name="question9" id="question9-radio-a" value="Rabbit"/>
						<label for="question9-radio-a">A. Rabbit</label>
						<input type="radio" name="question9" id="question9-radio-b" value="Horse"/>
						<label for="question9-radio-b">B. Horse</label>
						<input type="radio" name="question9" id="question9-radio-c" value="Moose"/>
						<label for="question9-radio-c">C. Moose</label>
						<input type="radio" name="question9" id="question9-radio-d" value="Dog"/>
						<label for="question9-radio-d">D. Dog</label>
				</fieldset>
				</div>
				
				<div data-role="fieldcontain">
				<fieldset data-role "controlgroup" data-type="vertical">
					<legend>Final Question: What weighs the same as a witch?</legend>
						<input type="radio" name="question10" id="question10-radio-a" value="Pug"/>
						<label for="question10-radio-a">A. Pug</label>
						<input type="radio" name="question10" id="question10-radio-b" value="Duck"/>
						<label for="question10-radio-b">B. Duck</label>
						<input type="radio" name="question10" id="question10-radio-c" value="Rabbit"/>
						<label for="question10-radio-c">C. Rabbit</label>
						<input type="radio" name="question10" id="question10-radio-d" value="Wood"/>
						<label for="question10-radio-d">D. Wood</label>
				</fieldset>
				</div>
				<button type="button" name="submit" id="submit" onclick="calculateScore()"data-theme="b">Submit</button>
						
				
			</form>
				
				
		</div>
	</body>
</html>